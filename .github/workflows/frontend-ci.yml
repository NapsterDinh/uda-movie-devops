#Workflow name
name: 'Frontend Github Workflow CI'

run-name: ${{ github.actor }} is trigger this ${{ github.workflow }}

on: 
  pull_request:
    branches: [main]
    paths: 
      - starter/frontend/**
      
  workflow_dispatch:
  
concurrency:
  group: '${{ github.workflow }} @ ${{ github.event.pull_request.head.label || github.head_ref || github.ref }}'
  cancel-in-progress: true  
  
jobs:
  build:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        node-version-file: ['.nvmrc']
        working-directory: ['starter/frontend']     
    defaults:
      run: 
        shell: bash
        working-directory: ${{ matrix.working-directory }}
    steps:
      - name: Lint and test
        uses: ./.github/workflows/frontend-lint-test.yaml
        with:
          working-directory: ${{ matrix.working-directory }}
          node-version-file: ${{ matrix.node-version-file }}
      # This step checks out a copy of source code in target branch of your repository
      - name: Checkout Repository
        uses: actions/checkout@v4 
        
      - name: Build
        run: npm run build
    
  